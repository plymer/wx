<!DOCTYPE html>
<html>

<head>
  <title>Image Preload Test</title>
  <meta charset="utf-8">
  <style>
    img { width: 25%; }

    #progress-container { display: block; text-align: center; }

    #progress-bar { width: 0%; background: red; height: 1em; }

  </style>

  <script>
    // set the global counters and arrays to contain the preloaded images
    var images = [];
    var preloadCount = 0;
    var maxImages = 25;
    var startIndex = 13;

    function preloadImages() {

      // reset all counters and arrays of images
      preloadCount = 0;
      images = [];

      // get the date to avoid caching images from previous loading attempts
      var d = new Date();

      // image-specific details for building the URL
      var url = "https://www.umanitoba.ca/environment/envirogeog/weather/images/sat/SaskShortN";
      var xtnsn = ".jpg" + "?" + d.getTime();


      // we'll begin the actual preload process here and decide how many images we're loading
      for (i = startIndex; i <= maxImages; i++) {
        // create a new image DOM object
        var img = new Image();

        // set the source programmatically to what we want based on our index position and end position
        img.src = url + i.toString() + xtnsn;

        // we set a trigger for when the image has finished loading
        img.onload = function() {
          // when the file is loaded by the browser, we want to indicate this visually
          // first, we increment the counter to be able to recognize where we're at in our process
          preloadCount++;

          // next, we grab the DOM elements we're using to update the user about the progress
          var counter = document.getElementById("counter");
          var progressBar = document.getElementById("progress-bar");

          // update the DOM elements that indicate our process
          counter.innerHTML = preloadCount + " images loaded.";
          progressBar.style.width = ((preloadCount - 1)/(maxImages-startIndex))*100 + "%";

          // we'll add a function call to check our loading status and whether there are
          // any actions we can take at this point in the preload
          addImages();

        }

       // after we've set all of our image's attributes (including the 'loaded' trigger)
       // we'll add this image object to an array of the images to be preloaded
       images.push(img);

      }

    }

    function addImages() {
      // before we do anything, make sure we've loaded all of the images
      if ((preloadCount - 1) == (maxImages - startIndex)) {
        // this is an example, but we'll loop through all of our images now and display them on the page
        for (i = 0; i < (maxImages - startIndex); i++) {
          document.getElementsByTagName("body")[0].append(images[i]);
        }
      }

    }

  </script>
</head>

<body>

<section id="progress-container">
  <p id="counter">No images loaded.</p>
  <div id="progress-bar"></div>
</section>

<button onclick="preloadImages()">Load Images</button>

</body>

</html>
